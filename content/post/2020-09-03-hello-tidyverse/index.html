---
title: Hello Tidyverse and generating many linear regression models
author: Gabe Mednick
date: '2020-09-03'
slug: hello-tidyverse
categories: []
tags: []
subtitle: 'Always a work in progress'
summary: 'This post explores crop yield data with visualization and the lm() function to generate models for 25 countries and 4 crops.'
authors: []
lastmod: '2020-10-20'
featured: no
disable_jquery: no
image:
  caption: '[Photo by Jesse Gardner on Unsplash](https://unsplash.com/photos/JYU14tnbfOA)'
  focal_point: ''
  preview_only: no
projects: []
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<div id="intro" class="section level1">
<h1>Intro</h1>
<p>This post uses data from the <i class='fab fa-r-project'  style='color: #367588'></i> for Data Science online learning community. Each Tuesday, a dataset is posted and people share their insights and visualizations like fine wine. You can Twitter the hashtag #TidyTuesday to sample the vintage of the week. This week’s dataset (September 1st, 2020) is from <a href="https://ourworldindata.org/crop-yields">Our World in Data</a>. There are actually five datasets but we are going to focus on global crop yields.</p>
<p>After exploring the data, we will create a model that predict the yield per hectare (yield_hectare ~ population + year), using the year and population. The dataset is too big to use every country and crop we will choose the top 25 countries by population and select 4 common crops. Altother, that will produce 100 linear models. Since that’s too much to digest in a table, we will present the model results as a labeled data visualization where each point represents a model’s adjusted p-value (y-axis) and estimate or slope (x-axis) for a given country and crop.</p>
</div>
<div id="download-and-view-the-data" class="section level1">
<h1>Download and view the data</h1>
<p>Let’s start by downloading the data from the <a href="https://github.com/rfordatascience/tidytuesday">R4DS Github</a> account and take a look at it. The tidytuesdayR package (by Ellis Hughes, co-host of the screencast ‘TidyX’) is a handy package for checking out available datasets, exploring the data dictionary in the Rstudio viewer and loading the desired data (and more). Although simple to use, I’m going to stick with the <code>readr::read_csv()</code> to import the data as a tibble (<code>Tidyverse</code> lingo for a modern dataframe object).</p>
<pre class="r"><code># Load the data with a readr function
crop_yields &lt;- read_csv(&quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-01/key_crop_yields.csv&quot;) %&gt;% 
  janitor::clean_names() 

land_use &lt;- read_csv(&quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-01/land_use_vs_yield_change_in_cereal_production.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  select(entity, code, year, population = total_population_gapminder) %&gt;% 
  mutate(year = as.numeric(year))

crop_yield &lt;- crop_yields %&gt;% 
  left_join(land_use, by = c(&#39;code&#39;,  &#39;year&#39;, &#39;entity&#39;))

skimr::skim(crop_yields)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-2">Table 1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">crop_yields</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">13075</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">14</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">12</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<colgroup>
<col width="19%" />
<col width="13%" />
<col width="19%" />
<col width="5%" />
<col width="5%" />
<col width="8%" />
<col width="12%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">entity</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">4</td>
<td align="right">39</td>
<td align="right">0</td>
<td align="right">249</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">code</td>
<td align="right">1919</td>
<td align="right">0.85</td>
<td align="right">3</td>
<td align="right">8</td>
<td align="right">0</td>
<td align="right">214</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<colgroup>
<col width="26%" />
<col width="8%" />
<col width="12%" />
<col width="6%" />
<col width="5%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">1990.37</td>
<td align="right">16.73</td>
<td align="right">1961.00</td>
<td align="right">1976.00</td>
<td align="right">1991.00</td>
<td align="right">2005.00</td>
<td align="right">2018.00</td>
<td align="left">▇▆▇▇▇</td>
</tr>
<tr class="even">
<td align="left">wheat_tonnes_per_hectare</td>
<td align="right">4974</td>
<td align="right">0.62</td>
<td align="right">2.43</td>
<td align="right">1.69</td>
<td align="right">0.00</td>
<td align="right">1.23</td>
<td align="right">1.99</td>
<td align="right">3.12</td>
<td align="right">10.67</td>
<td align="left">▇▅▂▁▁</td>
</tr>
<tr class="odd">
<td align="left">rice_tonnes_per_hectare</td>
<td align="right">4604</td>
<td align="right">0.65</td>
<td align="right">3.16</td>
<td align="right">1.85</td>
<td align="right">0.20</td>
<td align="right">1.77</td>
<td align="right">2.74</td>
<td align="right">4.16</td>
<td align="right">10.68</td>
<td align="left">▇▇▃▁▁</td>
</tr>
<tr class="even">
<td align="left">maize_tonnes_per_hectare</td>
<td align="right">2301</td>
<td align="right">0.82</td>
<td align="right">3.02</td>
<td align="right">3.13</td>
<td align="right">0.03</td>
<td align="right">1.14</td>
<td align="right">1.83</td>
<td align="right">3.92</td>
<td align="right">36.76</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">soybeans_tonnes_per_hectare</td>
<td align="right">7114</td>
<td align="right">0.46</td>
<td align="right">1.45</td>
<td align="right">0.75</td>
<td align="right">0.00</td>
<td align="right">0.86</td>
<td align="right">1.33</td>
<td align="right">1.90</td>
<td align="right">5.95</td>
<td align="left">▇▇▂▁▁</td>
</tr>
<tr class="even">
<td align="left">potatoes_tonnes_per_hectare</td>
<td align="right">3059</td>
<td align="right">0.77</td>
<td align="right">15.40</td>
<td align="right">9.29</td>
<td align="right">0.84</td>
<td align="right">8.64</td>
<td align="right">13.41</td>
<td align="right">20.05</td>
<td align="right">75.30</td>
<td align="left">▇▅▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">beans_tonnes_per_hectare</td>
<td align="right">5066</td>
<td align="right">0.61</td>
<td align="right">1.09</td>
<td align="right">0.82</td>
<td align="right">0.03</td>
<td align="right">0.59</td>
<td align="right">0.83</td>
<td align="right">1.35</td>
<td align="right">9.18</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">peas_tonnes_per_hectare</td>
<td align="right">6840</td>
<td align="right">0.48</td>
<td align="right">1.48</td>
<td align="right">1.01</td>
<td align="right">0.04</td>
<td align="right">0.72</td>
<td align="right">1.15</td>
<td align="right">1.99</td>
<td align="right">7.16</td>
<td align="left">▇▃▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">cassava_tonnes_per_hectare</td>
<td align="right">5887</td>
<td align="right">0.55</td>
<td align="right">9.34</td>
<td align="right">5.11</td>
<td align="right">1.00</td>
<td align="right">5.55</td>
<td align="right">8.67</td>
<td align="right">11.99</td>
<td align="right">38.58</td>
<td align="left">▇▇▁▁▁</td>
</tr>
<tr class="even">
<td align="left">barley_tonnes_per_hectare</td>
<td align="right">6342</td>
<td align="right">0.51</td>
<td align="right">2.23</td>
<td align="right">1.50</td>
<td align="right">0.09</td>
<td align="right">1.05</td>
<td align="right">1.88</td>
<td align="right">3.02</td>
<td align="right">9.15</td>
<td align="left">▇▆▂▁▁</td>
</tr>
<tr class="odd">
<td align="left">cocoa_beans_tonnes_per_hectare</td>
<td align="right">8466</td>
<td align="right">0.35</td>
<td align="right">0.39</td>
<td align="right">0.28</td>
<td align="right">0.00</td>
<td align="right">0.24</td>
<td align="right">0.36</td>
<td align="right">0.49</td>
<td align="right">3.43</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">bananas_tonnes_per_hectare</td>
<td align="right">4166</td>
<td align="right">0.68</td>
<td align="right">15.20</td>
<td align="right">12.08</td>
<td align="right">0.66</td>
<td align="right">5.94</td>
<td align="right">11.78</td>
<td align="right">20.79</td>
<td align="right">77.59</td>
<td align="left">▇▃▁▁▁</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Here are a few other options for getting to know the data
# glimpse(crop_yields) 
# summary(crop_yields)
# View(crop_yields)</code></pre>
</div>
<div id="tidy-data-cleaning-and-reshaping" class="section level1">
<h1>Tidy data: cleaning and reshaping</h1>
<p>Let’s start with a little data cleaning! <code>skim()</code> from <code>skimr</code> provides a convenient way to get summary statistics and more. By looking at the data we can see that there are missing values that need to be removed or imputed but other than that, the data is clean. One thing we should consider is whether the data is in a tidy format where each column is a feature and each row a sample. This format is important when we want to model the data but sometimes it’s helpful to pivot the data into a long format for creating visualizations across multiple categories with <code>ggplot2::facet_wrap()</code> and related functions. We will use the handy function, <code>pivot_longer()</code>, from the tidyr package to combine crops into a single column and present their respective values in a separate column in preparation for exploratory data analysis (EDA).</p>
<pre class="r"><code># Use pivot_longer from tidyr to tidy the data.
crop_yield_tidy &lt;- crop_yield %&gt;% 
  rename_all(str_remove, &quot;_tonnes.*&quot;) %&gt;% 
  rename(country = entity) %&gt;% 
  pivot_longer(wheat:bananas, names_to = &#39;crop&#39;, values_to = &#39;yield_hectare&#39;) %&gt;% 
  drop_na(yield_hectare) 

# Create a vector of the 25 countries with the largest population
top_pops &lt;- land_use  %&gt;%
  filter(!is.na(code), entity != &quot;World&quot;) %&gt;% 
  group_by(entity) %&gt;% 
  filter(year == max(year)) %&gt;% 
  ungroup() %&gt;% 
  slice_max(population, n = 25) %&gt;% 
  pull(entity)


kable(head(crop_yield_tidy, n = 10))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="left">code</th>
<th align="right">year</th>
<th align="right">population</th>
<th align="left">crop</th>
<th align="right">yield_hectare</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="left">AFG</td>
<td align="right">1961</td>
<td align="right">9169000</td>
<td align="left">wheat</td>
<td align="right">1.0220</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="left">AFG</td>
<td align="right">1961</td>
<td align="right">9169000</td>
<td align="left">rice</td>
<td align="right">1.5190</td>
</tr>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="left">AFG</td>
<td align="right">1961</td>
<td align="right">9169000</td>
<td align="left">maize</td>
<td align="right">1.4000</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="left">AFG</td>
<td align="right">1961</td>
<td align="right">9169000</td>
<td align="left">potatoes</td>
<td align="right">8.6667</td>
</tr>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="left">AFG</td>
<td align="right">1961</td>
<td align="right">9169000</td>
<td align="left">barley</td>
<td align="right">1.0800</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="left">AFG</td>
<td align="right">1962</td>
<td align="right">9351000</td>
<td align="left">wheat</td>
<td align="right">0.9735</td>
</tr>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="left">AFG</td>
<td align="right">1962</td>
<td align="right">9351000</td>
<td align="left">rice</td>
<td align="right">1.5190</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="left">AFG</td>
<td align="right">1962</td>
<td align="right">9351000</td>
<td align="left">maize</td>
<td align="right">1.4000</td>
</tr>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="left">AFG</td>
<td align="right">1962</td>
<td align="right">9351000</td>
<td align="left">potatoes</td>
<td align="right">7.6667</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="left">AFG</td>
<td align="right">1962</td>
<td align="right">9351000</td>
<td align="left">barley</td>
<td align="right">1.0800</td>
</tr>
</tbody>
</table>
</div>
<div id="what-can-we-learn-from-this-dataset" class="section level1">
<h1>What can we learn from this dataset?</h1>
<p>A great place to start any analysis is by counting the representation of certain categories in the dataset using the <code>count()</code> or <code>add_count()</code> function. For instance, we might want to know the count of each country across years which will tell us the number of crops recorded for each country. It often makes sense to combine <code>count()</code> with a bar plot to visualize meaningful distributions.</p>
<p>EDA is often where I have the most fun in my workflow..plus it’s arguably the most important step in a data analysis pipeline. Among other things, it provides insights that will help us have an intuitive sense about what to expect when we generate machine learning models and evaluate their performance.</p>
<pre class="r"><code>crop_yield_tidy %&gt;%
  add_count(year, country, sort = T) %&gt;% 
  filter(country %in% c(&quot;Albania&quot;, &quot;Africa&quot;, &quot;United States&quot;)) # Africa has 11 crops, US has 9 and Albania 6. </code></pre>
<pre><code>## # A tibble: 1,522 × 7
##    country code   year population crop        yield_hectare     n
##    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;int&gt;
##  1 Africa  &lt;NA&gt;   1961  290214016 wheat               0.693    11
##  2 Africa  &lt;NA&gt;   1961  290214016 rice                1.55     11
##  3 Africa  &lt;NA&gt;   1961  290214016 maize               1.04     11
##  4 Africa  &lt;NA&gt;   1961  290214016 soybeans            0.376    11
##  5 Africa  &lt;NA&gt;   1961  290214016 potatoes            8.18     11
##  6 Africa  &lt;NA&gt;   1961  290214016 beans               0.587    11
##  7 Africa  &lt;NA&gt;   1961  290214016 peas                0.679    11
##  8 Africa  &lt;NA&gt;   1961  290214016 cassava             5.66     11
##  9 Africa  &lt;NA&gt;   1961  290214016 barley              0.446    11
## 10 Africa  &lt;NA&gt;   1961  290214016 cocoa_beans         0.254    11
## # … with 1,512 more rows</code></pre>
<pre class="r"><code>crop_yield_tidy %&gt;%
  count(country, sort = TRUE) %&gt;%
  filter(n &gt;=500) # this gives a list of the countries with the most years + crops 11 (crops) * 51 (year) = 561</code></pre>
<pre><code>## # A tibble: 53 × 2
##    country                               n
##    &lt;chr&gt;                             &lt;int&gt;
##  1 Africa                              638
##  2 Americas                            638
##  3 Asia                                638
##  4 Central America                     638
##  5 Democratic Republic of Congo        638
##  6 Eastern Africa                      638
##  7 Ecuador                             638
##  8 Land Locked Developing Countries    638
##  9 Least Developed Countries           638
## 10 Low Income Food Deficit Countries   638
## # … with 43 more rows</code></pre>
<pre class="r"><code>crop_yield_tidy %&gt;%
  summarize(max(year)- min(year)) #57 years of recorded data</code></pre>
<pre><code>## # A tibble: 1 × 1
##   `max(year) - min(year)`
##                     &lt;dbl&gt;
## 1                      57</code></pre>
<pre class="r"><code>crop_yield_tidy %&gt;% # 249 unique countries
  distinct(country) %&gt;% 
  nrow()</code></pre>
<pre><code>## [1] 249</code></pre>
</div>
<div id="visual-analysis" class="section level1">
<h1>Visual analysis</h1>
<p>Let’s start by comparing crop yield by country for the United States to see how crop yields have changed over time. While we’re at it, let’s look at the most abundant crop yields overall.</p>
<pre class="r"><code># Potatoes!
us_yields &lt;- crop_yield_tidy %&gt;% 
  filter(country == &#39;United States&#39;) %&gt;% 
  ggplot(aes(year, yield_hectare, color = crop)) +
  geom_line() +
  facet_wrap(~country, &#39;free_x&#39;) +
  theme(plot.title.position = &#39;plot&#39;) +
  labs(
    title = &#39;Crop Yield USA&#39;,
    y = &#39;Year&#39;,
    x = &#39;tonnes per hectare per year&#39;
  )

us_yields</code></pre>
<p><img src="staticunnamed-chunk-5-1.png" width="3000" /></p>
<pre class="r"><code># plot of USA data only
crop_yield_tidy %&gt;% 
  filter(country == &#39;United States&#39;) %&gt;% 
  mutate(crop = fct_reorder(crop, yield_hectare)) %&gt;%
  ggplot(aes(yield_hectare, crop, fill = crop)) +
  geom_col()  +
  facet_wrap(~country, scales = &#39;free_y&#39;) +
  theme(legend.position =  &#39;none&#39;,
        plot.title.position = &#39;plot&#39;) +
  labs(
    title = &#39;Crop Yield USA&#39;,
    y = &#39;Crop&#39;,
    x = &#39;tonnes per hectare&#39;
  )</code></pre>
<p><img src="staticunnamed-chunk-5-2.png" width="3000" /></p>
<p>There are too many countries to add to a single plot, so we will likely need to decide how we want to subset the data. For this analysis, let’s use <code>dplyr::slice_sample()</code> to randomly select a subset of the total countries. Unless a seed is set, the selection will be different each time we run the code chunk. To start, let’s choose 9 countries and visualize the change in crop yields over time.</p>
<pre class="r"><code># set.seed(1014) if you want to select the same 9 countries each time

# Randomly select 9 country names
crops &lt;- crop_yield_tidy %&gt;% distinct(crop) %&gt;%  pull()

country_random &lt;- crop_yield_tidy %&gt;% 
  select(country) %&gt;% 
  distinct() %&gt;% 
  slice_sample(n = 9) %&gt;% 
  pull()

# Plot crop yield per hectare per year.
crop_yield_tidy %&gt;% 
  filter(country %in% country_random,
         crop %in% c(&#39;maize&#39;, &#39;potatoes&#39;, &#39;wheat&#39;, &#39;bananas&#39;)) %&gt;% 
  mutate(crop = fct_reorder(crop, yield_hectare)) %&gt;% 
  ggplot(aes(year, yield_hectare, color = crop)) +
  geom_line(size = 1, alpha = 0.5) +
  facet_wrap(~country, scales = &#39;free_y&#39;) +
  theme(plot.title.position = &#39;plot&#39;) +
  labs(
     y = &#39;yield per hectare&#39;,
    title = &#39;Crop Yield&#39;
  )</code></pre>
<p><img src="staticunnamed-chunk-6-1.png" width="3000" /></p>
<pre class="r"><code>crop_yield_tidy %&gt;% 
  filter(country %in% top_pops,
         crop == c(&#39;maize&#39;, &#39;potatoes&#39;, &#39;wheat&#39;, &#39;bananas&#39;)) %&gt;% 
  mutate(crop = reorder_within(crop, yield_hectare, country)) %&gt;%
  ggplot(aes(yield_hectare, crop, fill = crop)) +
  geom_col()  +
  scale_y_reordered() +
  facet_wrap(~country, scales = &#39;free&#39;) +
  theme(legend.position = &#39;none&#39;,
        plot.title.position = &#39;plot&#39;) +
  labs(
    title = &#39;Crop Yield&#39;,
    y = &#39;Crop&#39;,
    x = &#39;yield per hectare&#39;
  )</code></pre>
<p><img src="staticunnamed-chunk-7-1.png" width="3000" /></p>
<pre class="r"><code>crop_yield_tidy %&gt;% 
  filter(country %in% top_pops,
         crop %in% c(&#39;maize&#39;, &#39;potatoes&#39;, &#39;wheat&#39;, &#39;bananas&#39;)) %&gt;% 
  mutate(crop = fct_reorder(crop, yield_hectare)) %&gt;% 
  ggplot(aes(year, yield_hectare, color = crop)) +
  geom_line(size = 1, alpha = 0.5) +
  theme(plot.title.position = &#39;plot&#39;) +
  facet_wrap(~country, scales = &#39;free_y&#39;) +
  labs(
     y = &#39;yield per hectare&#39;,
    title = &#39;Crop Yield&#39;
  )</code></pre>
<p><img src="staticunnamed-chunk-8-1.png" width="3000" /></p>
<p>Next, let’s make a regression model for each of the top 25 countries.</p>
<pre class="r"><code>library(broom)
library(ggrepel)

many_models &lt;- crop_yield_tidy %&gt;%
  drop_na() %&gt;%
  filter(country %in% top_pops,
         crop %in% c(&#39;maize&#39;, &#39;potatoes&#39;, &#39;wheat&#39;, &#39;bananas&#39;)) %&gt;%
  nest(mod_data = c(year, yield_hectare, population)) %&gt;%
  mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %&gt;%
  mutate(coefs = map(model, tidy)) %&gt;%
  unnest(coefs)</code></pre>
<p>Here’s what the data looks like after unnesting the coefficients.</p>
<pre class="r"><code>many_models %&gt;% 
  select(country, code, crop, term, estimate, std.error, statistic, p.value, everything()) %&gt;% 
  head()</code></pre>
<pre><code>## # A tibble: 6 × 10
##   country    code  crop  term    estimate std.error statistic  p.value
##   &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 Bangladesh BGD   wheat (Inter… -4.02e+2   4.99e+1     -8.06 6.96e-11
## 2 Bangladesh BGD   wheat popula… -8.05e-8   1.23e-8     -6.56 1.95e- 8
## 3 Bangladesh BGD   wheat year     2.07e-1   2.57e-2      8.06 7.01e-11
## 4 Bangladesh BGD   maize (Inter…  5.31e+2   2.63e+2      2.02 4.85e- 2
## 5 Bangladesh BGD   maize popula…  1.90e-7   6.47e-8      2.94 4.84e- 3
## 6 Bangladesh BGD   maize year    -2.76e-1   1.36e-1     -2.03 4.71e- 2
## # … with 2 more variables: mod_data &lt;list&gt;, model &lt;list&gt;</code></pre>
<p>Finally, let’s make the results more meaningful by creating a visualization to summarize the model results.</p>
<pre class="r"><code>many_models %&gt;%
  filter(term == &quot;year&quot;) %&gt;%
  mutate(p.value = p.adjust(p.value)) %&gt;% 
  ggplot(aes(estimate, p.value, label = country)) +
  geom_vline(xintercept = 0, lty = 2, 
               size = 1.5, alpha = 0.7, color = &quot;gray50&quot;) +
  geom_point(aes(color = crop), alpha = 0.8, size = 2.5, show.legend = FALSE) +
  scale_y_log10() +
  facet_wrap(~crop) +
  geom_text_repel(size = 2.5, family = &quot;Times New Roman&quot;) </code></pre>
<p><img src="staticunnamed-chunk-11-1.png" width="3000" /></p>
</div>
